<!-- 
4
-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Streamer Roulette</title>
<style>
  body {
    background: #111;
    color: #eee;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 40px;
  }
  #random-btn {
    padding: 20px 40px;
    font-size: 1.6rem;
    cursor: pointer;
    border: none;
    border-radius: 10px;
    background: #9146ff;
    color: white;
    transition: transform 0.2s;
  }
  #random-btn:hover { transform: scale(1.05); }
  .section { margin-top: 40px; }
  .streamer-card {
    display: inline-block;
    margin: 10px;
    text-align: center;
    transition: transform 0.2s;
  }
  .streamer-card:hover { transform: scale(1.05); }
  .avatar { width: 80px; height: 80px; border-radius: 50%; }
  .live { box-shadow: 0 0 20px #9146ff; }
  .offline { filter: grayscale(100%); opacity: 0.5; }
</style>
</head>
<body>
  <h1>ðŸŽ² Streamer Roulette</h1>
  <button id="random-btn">Random Live Streamer</button>

  <div class="section" id="online-container">
    <h2>ðŸŸ¢ Online</h2>
  </div>

  <div class="section" id="offline-container">
    <h2>âšª Offline</h2>
  </div>

<script>
const WORKER_URL = 'https://twitch-proxy.harumotohayako.workers.dev?all=true';
const REFRESH_INTERVAL = 60000;

async function fetchStreamers() {
  const res = await fetch(WORKER_URL);
  const data = await res.json();
  return data;
}

function renderStreamers(data) {
  const onlineDiv = document.getElementById('online-container');
  const offlineDiv = document.getElementById('offline-container');
  onlineDiv.innerHTML = '<h2>ðŸŸ¢ Online</h2>';
  offlineDiv.innerHTML = '<h2>âšª Offline</h2>';

  const shuffle = arr => arr.sort(() => Math.random() - 0.5);

  shuffle(data.online || []).forEach(s => {
    const card = document.createElement('div');
    card.className = 'streamer-card live';
    card.innerHTML = `
      <img src="${s.avatar || 'https://via.placeholder.com/80'}" class="avatar">
      <div>${s.user}</div>
      <div>${s.game}</div>
    `;
    card.onclick = () => window.open(`https://twitch.tv/${s.user}`, '_blank');
    onlineDiv.appendChild(card);
  });

  shuffle(data.offline || []).forEach(s => {
    const card = document.createElement('div');
    card.className = 'streamer-card offline';
    card.innerHTML = `
      <img src="${s.avatar || 'https://via.placeholder.com/80'}" class="avatar">
      <div>${s.user}</div>
      <div>${s.game}</div>
    `;
    card.onclick = () => window.open(`https://twitch.tv/${s.user}`, '_blank');
    offlineDiv.appendChild(card);
  });
}

async function refresh() {
  const data = await fetchStreamers();
  renderStreamers(data);
}

document.getElementById('random-btn').onclick = async () => {
  const data = await fetchStreamers();
  if (!data.online || data.online.length === 0) {
    alert('Nobody is live right now!');
    return;
  }
  const random = data.online[Math.floor(Math.random() * data.online.length)];
  window.open(`https://twitch.tv/${random.user}`, '_blank');
}

// Initial load + auto-refresh
refresh();
setInterval(refresh, REFRESH_INTERVAL);
</script>
</body>
</html>


